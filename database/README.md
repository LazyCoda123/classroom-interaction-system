# æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ

è¿™æ˜¯è¯¾å ‚äº’åŠ¨ç³»ç»Ÿçš„æ•°æ®åº“ç®¡ç†å·¥å…·ï¼Œè§£å†³äº†å¯†ç å“ˆå¸Œä¸åŒ¹é…çš„é—®é¢˜ï¼Œæä¾›äº†å®Œæ•´çš„æ•°æ®åº“åˆå§‹åŒ–å’Œç®¡ç†åŠŸèƒ½ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒé…ç½®

ç¡®ä¿ä½ çš„ç¯å¢ƒå˜é‡æˆ–ä½¿ç”¨é»˜è®¤é…ç½®ï¼š

```bash
# ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=123456
DB_NAME=classroom_system
```

### 2. ä¸€é”®åˆå§‹åŒ–

```bash
# å®Œæ•´åˆå§‹åŒ–æ•°æ®åº“ï¼ˆæ¨èï¼‰
npm run setup

# æˆ–è€…ä½¿ç”¨åŸå§‹å‘½ä»¤
npm run db:init
```

### 3. éªŒè¯å®‰è£…

```bash
# æµ‹è¯•æ•°æ®åº“è¿æ¥
npm run db:test

# æŸ¥çœ‹æ•°æ®åº“çŠ¶æ€
npm run db:status
```

## ğŸ“‹ é»˜è®¤è´¦å·ä¿¡æ¯

åˆå§‹åŒ–å®Œæˆåï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è´¦å·ç™»å½•ï¼š

### æ•™å¸ˆè´¦å·
- **å­¦å·**: `teacher001`
- **å¯†ç **: `secret`
- **è§’è‰²**: æ•™å¸ˆ

### å­¦ç”Ÿè´¦å·
- **å­¦å·**: `2024001` - `2024030`
- **å¯†ç **: `secret`
- **è§’è‰²**: å­¦ç”Ÿ

## ğŸ›  æ•°æ®åº“å‘½ä»¤

### åˆå§‹åŒ–å‘½ä»¤

```bash
# åˆå§‹åŒ–æ•°æ®åº“ï¼ˆå¦‚æœæ•°æ®å·²å­˜åœ¨ä¼šè·³è¿‡ï¼‰
npm run db:init

# é‡ç½®å¹¶åˆå§‹åŒ–æ•°æ®åº“ï¼ˆæ¸…ç©ºæ‰€æœ‰æ•°æ®é‡æ–°å¼€å§‹ï¼‰
npm run db:reset

# å¿«æ·å‘½ä»¤
npm run setup        # ç­‰åŒäº db:init
npm run setup:clean  # ç­‰åŒäº db:reset
```

### è¿ç§»å‘½ä»¤

```bash
# æ‰§è¡Œæ‰€æœ‰å¾…æ‰§è¡Œçš„è¿ç§»
npm run db:migrate

# å›æ»šæœ€åä¸€ä¸ªè¿ç§»
npm run db:migrate:down

# æŸ¥çœ‹è¿ç§»çŠ¶æ€
npm run db:migrate:status

# é‡ç½®æ‰€æœ‰è¿ç§»ï¼ˆå±é™©æ“ä½œï¼‰
npm run db:migrate:reset
```

### æ•°æ®ç®¡ç†å‘½ä»¤

```bash
# åªæ’å…¥ç§å­æ•°æ®ï¼ˆè¡¨ç»“æ„å¿…é¡»å·²å­˜åœ¨ï¼‰
npm run db:seed

# æ¸…ç©ºæ‰€æœ‰æ•°æ®
npm run db:clear

# æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
npm run db:status

# æµ‹è¯•æ•°æ®åº“è¿æ¥
npm run db:test

# ä¿®å¤å¯†ç å“ˆå¸Œé—®é¢˜
npm run db:fix-passwords
```

## ğŸ”§ é«˜çº§ç”¨æ³•

### ä½¿ç”¨æ•°æ®åº“å·¥å…·è„šæœ¬

```bash
# åˆ›å»ºæ–°ç”¨æˆ·
node database/db-tool.js create-user 2024999 å¼ ä¸‰ student

# åˆ›å»ºæ–°æ•™å¸ˆ
node database/db-tool.js create-user teacher002 ç‹è€å¸ˆ teacher

# æŸ¥çœ‹è¯¦ç»†å¸®åŠ©
node database/db-tool.js
```

### ä½¿ç”¨è¿ç§»å·¥å…·

```bash
# å›æ»šæŒ‡å®šæ­¥æ•°çš„è¿ç§»
node database/migrate.js down 2

# æŸ¥çœ‹è¿ç§»å¸®åŠ©
node database/migrate.js
```

## ğŸ“ ç›®å½•ç»“æ„

```
database/
â”œâ”€â”€ init.js              # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ db-tool.js           # æ•°æ®åº“ç®¡ç†å·¥å…·
â”œâ”€â”€ migrate.js           # è¿ç§»ç®¡ç†å™¨
â”œâ”€â”€ migrations/          # è¿ç§»æ–‡ä»¶ç›®å½•
â”‚   â””â”€â”€ 001_create_tables.js
â”œâ”€â”€ seeds/               # ç§å­æ•°æ®ç›®å½•
â”‚   â””â”€â”€ index.js
â”œâ”€â”€ schema.sql           # åŸå§‹SQLè„šæœ¬ï¼ˆå¤‡ç”¨ï¼‰
â””â”€â”€ README.md            # æœ¬æ–‡æ¡£
```

## â“ å¸¸è§é—®é¢˜

### Q: å­¦ç”Ÿæ— æ³•ç™»å½•æ€ä¹ˆåŠï¼Ÿ

**A**: è¿™é€šå¸¸æ˜¯å¯†ç å“ˆå¸Œé—®é¢˜ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ä¿®å¤ï¼š

```bash
npm run db:fix-passwords
```

### Q: å¦‚ä½•é‡ç½®æ•´ä¸ªæ•°æ®åº“ï¼Ÿ

**A**: ä½¿ç”¨é‡ç½®å‘½ä»¤ï¼š

```bash
npm run db:reset
```

### Q: å¦‚ä½•æ·»åŠ æ–°çš„æµ‹è¯•ç”¨æˆ·ï¼Ÿ

**A**: ä½¿ç”¨åˆ›å»ºç”¨æˆ·å‘½ä»¤ï¼š

```bash
node database/db-tool.js create-user å­¦å· å§“å è§’è‰²
```

### Q: æ•°æ®åº“è¿æ¥å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**A**: æ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š
1. MySQLæœåŠ¡æ˜¯å¦å¯åŠ¨
2. æ•°æ®åº“é…ç½®æ˜¯å¦æ­£ç¡®
3. ç”¨æˆ·æƒé™æ˜¯å¦è¶³å¤Ÿ

```bash
# æµ‹è¯•è¿æ¥
npm run db:test
```

### Q: å¦‚ä½•æŸ¥çœ‹å½“å‰æ•°æ®åº“çŠ¶æ€ï¼Ÿ

**A**: ä½¿ç”¨çŠ¶æ€æŸ¥çœ‹å‘½ä»¤ï¼š

```bash
npm run db:status
```

## ğŸ” å¯†ç å®‰å…¨

- æ‰€æœ‰å¯†ç ä½¿ç”¨ bcryptjs åŠ å¯†ï¼Œrounds=10
- é»˜è®¤å¯†ç ä¸º `secret`ï¼Œå»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¿®æ”¹
- ç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆæ­£ç¡®çš„å¯†ç å“ˆå¸Œï¼Œé¿å…æ‰‹åŠ¨é”™è¯¯

## ğŸŒ± ç§å­æ•°æ®

ç³»ç»ŸåŒ…å«ä»¥ä¸‹ç§å­æ•°æ®ï¼š

- **1ä¸ªæ•™å¸ˆè´¦å·**: teacher001
- **30ä¸ªå­¦ç”Ÿè´¦å·**: 2024001-2024030
- **6ä¸ªé—®é¢˜åˆ†ç±»**: æ¶µç›–å„ç§é—®é¢˜ç±»å‹
- **20ä¸ªæµ‹è¯•é—®é¢˜**: ç”¨äºæ¼”ç¤ºåŠŸèƒ½

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. **é‡ç½®æ“ä½œ**: `npm run db:reset` ä¼šåˆ é™¤æ‰€æœ‰æ•°æ®ï¼Œè¯·è°¨æ…ä½¿ç”¨
2. **ç”Ÿäº§ç¯å¢ƒ**: å»ºè®®ä¿®æ”¹é»˜è®¤å¯†ç å’Œæ•°æ®åº“é…ç½®
3. **å¤‡ä»½**: åœ¨æ‰§è¡Œé‡ç½®æ“ä½œå‰ï¼Œè¯·å¤‡ä»½é‡è¦æ•°æ®
4. **æƒé™**: ç¡®ä¿æ•°æ®åº“ç”¨æˆ·æœ‰è¶³å¤Ÿçš„æƒé™åˆ›å»ºè¡¨å’Œç´¢å¼•

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹é”™è¯¯æ—¥å¿—
2. è¿è¡Œ `npm run db:test` æµ‹è¯•è¿æ¥
3. è¿è¡Œ `npm run db:status` æŸ¥çœ‹çŠ¶æ€
4. ä½¿ç”¨ `npm run db:fix-passwords` ä¿®å¤å¯†ç é—®é¢˜

---

**æç¤º**: é¦–æ¬¡ä½¿ç”¨å»ºè®®è¿è¡Œ `npm run setup` è¿›è¡Œå®Œæ•´åˆå§‹åŒ–ã€‚